{"version":3,"sources":["webpack:///./node_modules/core-js/modules/es6.function.name.js","webpack:///./src/views/files.vue?b920","webpack:///./src/views/files.vue?cf56","webpack:///src/views/files.vue","webpack:///./src/views/files.vue?5586","webpack:///./src/views/files.vue"],"names":["dP","f","FProto","Function","prototype","nameRE","NAME","configurable","get","this","match","e","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","$event","$router","push","openDialog","_v","directives","name","rawName","value","expression","rows","_l","column","index","key","title","width","minWidth","fixed","scopedSlots","_u","fn","scope","_s","aliasFilter","row","format","downloadItem","filterList","length","currentPage","dialogShow","ref","file","nativeOn","pickFile","uploadProcessing","model","callback","$$v","$set","setFile","slot","submit","staticRenderFns","component"],"mappings":"8HAAA,IAAIA,EAAK,EAAQ,QAAgBC,EAC7BC,EAASC,SAASC,UAClBC,EAAS,wBACTC,EAAO,OAGXA,KAAQJ,GAAU,EAAQ,SAAqBF,EAAGE,EAAQI,EAAM,CAC9DC,cAAc,EACdC,IAAK,WACH,IACE,OAAQ,GAAKC,MAAMC,MAAML,GAAQ,GACjC,MAAOM,GACP,MAAO,Q,kCCZb,yBAAie,EAAG,G,yCCApe,IAAIC,EAAS,WAAa,IAAIC,EAAIJ,KAASK,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,iBAAiB,CAACG,MAAM,CAAC,QAAU,QAAQC,GAAG,CAAC,KAAO,SAASC,GAAQ,OAAOR,EAAIS,QAAQC,KAAK,SAASP,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQP,EAAIW,aAAa,CAACX,EAAIY,GAAG,WAAW,GAAGT,EAAG,WAAW,CAACU,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAYC,MAAOhB,EAAW,QAAEiB,WAAW,YAAYZ,YAAY,aAAaC,MAAM,CAAC,KAAON,EAAIkB,KAAK,OAAS,GAAG,OAAS,KAAK,CAAClB,EAAImB,GAAInB,EAAW,SAAE,SAASoB,EAAOC,GAAO,OAAOlB,EAAG,kBAAkB,CAACmB,IAAID,EAAMf,MAAM,CAAC,KAAOc,EAAON,KAAK,MAAQM,EAAOG,MAAM,MAAQH,EAAOI,MAAM,YAAYJ,EAAOK,SAAS,yBAAwB,EAAK,MAAQL,EAAOM,MAAM,SAAW,IAAIC,YAAY3B,EAAI4B,GAAG,CAAC,CAACN,IAAI,UAAUO,GAAG,SAASC,GAAO,MAAO,CAAC9B,EAAIY,GAAG,qBAAqBZ,EAAI+B,GAAmB,UAAhBX,EAAON,KAAmBd,EAAIgC,YAAYF,EAAMG,IAAIb,EAAON,OAAUM,EAAOc,OACl7Bd,EAAOc,OAAOJ,EAAMG,IAAIb,EAAON,OAASgB,EAAMG,IAAIb,EAAON,OAAQ,sBAAsB,MAAK,QAAUX,EAAG,kBAAkB,CAACG,MAAM,CAAC,MAAQ,KAAK,YAAY,MAAM,MAAQ,MAAM,MAAQ,SAASqB,YAAY3B,EAAI4B,GAAG,CAAC,CAACN,IAAI,UAAUO,GAAG,SAASC,GAAO,MAAO,CAAC3B,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,OAAO,KAAO,UAAU,KAAO,oBAAoBC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOR,EAAImC,aAAaL,EAAMG,iBAAiB,GAAG9B,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAACF,EAAG,gBAAgB,CAACG,MAAM,CAAC,WAAa,GAAG,OAAS,oBAAoB,MAAQN,EAAIoC,WAAWC,OAAO,eAAerC,EAAIsC,YAAY,uBAAsB,GAAM/B,GAAG,CAAC,qBAAqB,SAASC,GAAQR,EAAIsC,YAAY9B,GAAQ,sBAAsB,SAASA,GAAQR,EAAIsC,YAAY9B,OAAY,GAAGL,EAAG,YAAY,CAACG,MAAM,CAAC,MAAQ,OAAO,QAAUN,EAAIuC,WAAW,MAAQ,QAAQ,wBAAuB,GAAOhC,GAAG,CAAC,iBAAiB,SAASC,GAAQR,EAAIuC,WAAW/B,GAAQ,OAAS,SAASA,GAAQR,EAAIuC,YAAa,KAAS,CAACpC,EAAG,UAAU,CAACqC,IAAI,UAAUlC,MAAM,CAAC,MAAQN,EAAIyC,KAAK,cAAc,UAAU,CAACtC,EAAG,eAAe,CAACG,MAAM,CAAC,KAAO,MAAM,MAAQ,QAAQoC,SAAS,CAAC,MAAQ,SAASlC,GAAQ,OAAOR,EAAI2C,SAASnC,MAAW,CAACL,EAAG,WAAW,CAACG,MAAM,CAAC,YAAc,WAAW,SAAWN,EAAI4C,kBAAkBC,MAAM,CAAC7B,MAAOhB,EAAIyC,KAAQ,IAAEK,SAAS,SAAUC,GAAM/C,EAAIgD,KAAKhD,EAAIyC,KAAM,MAAOM,IAAM9B,WAAW,cAAcd,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,QAAQ,CAACqC,IAAI,aAAalC,MAAM,CAAC,KAAO,QAAQC,GAAG,CAAC,OAASP,EAAIiD,cAAc,IAAI,GAAG9C,EAAG,MAAM,CAACG,MAAM,CAAC,KAAO,UAAU4C,KAAK,UAAU,CAAC/C,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,SAASC,GAAG,CAAC,MAAQ,SAASC,GAAQR,EAAIuC,YAAa,KAAS,CAACvC,EAAIY,GAAG,QAAQT,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO,UAAU,KAAO,QAAQ,QAAUN,EAAI4C,kBAAkBrC,GAAG,CAAC,MAAQP,EAAImD,SAAS,CAACnD,EAAIY,GAAGZ,EAAI+B,GAAG/B,EAAI4C,iBAAmB,SAAW,UAAU,IAAI,IAAI,IACj0DQ,EAAkB,G,gDCkEtB,GACA,CACE,MAAF,OACE,KAAF,QAEA,CACE,MAAF,OACE,KAAF,SAMA,GACE,KAAF,WAAI,MAAJ,CACM,QAAN,EACM,SAAN,EACM,YAAN,EACM,YAAN,EACM,IAAN,KACM,KAAN,CACQ,IAAR,IAEM,WAAN,GACM,kBAAN,IAEE,QAAF,CACI,WADJ,WAEM,KAAN,cACA,WACQ,KAAR,0BACQ,KAAR,SACQ,KAAR,aAEM,QAAN,OAEI,aAVJ,WAUM,IAAN,OACM,KAAN,WACM,EAAN,MACQ,QAAR,YACU,IAAV,KACU,GAAV,EACY,IAAZ,WACc,EAAd,gBAGY,EAAZ,QAEU,EAAV,uCAAY,IAAZ,QAAgB,EAAhB,OAAgB,EAAhB,OACY,MAAZ,CACc,IAAd,EAAc,KAAd,EACc,KAAd,sBAEA,GACU,EAAV,YAEQ,KAAR,YACU,EAAV,+BACU,EAAV,eAII,SApCJ,SAoCA,GAAM,IACN,wBACM,EAAN,QACM,YAAN,WACQ,EAAR,gBACA,MAEI,QA3CJ,SA2CA,GACM,IAAN,iBACA,YACQ,KAAR,SACQ,KAAR,oBAEQ,KAAR,UAGI,aApDJ,YAoDM,IAAN,QACM,OAAN,sDAEI,OAvDJ,WAuDM,IAAN,OACM,GAAN,SAAM,CACA,KAAN,oBACM,IAAN,eACM,EAAN,wBACM,EAAN,QACQ,QAAR,YACU,EAAV,cACU,EAAV,eACU,EAAV,qBAEQ,KAAR,YACU,EAAV,2BACU,EAAV,0BAKE,SAAF,CACI,KADJ,WAEM,IAAN,0BACM,OAAN,gCAGE,QA5FF,WA6FI,KAAJ,iBC9K+U,I,wBCQ3UC,EAAY,eACd,EACAtD,EACAqD,GACA,EACA,KACA,WACA,MAIa,aAAAC,E","file":"js/chunk-0f170314.a5875d0b.js","sourcesContent":["var dP = require('./_object-dp').f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || require('./_descriptors') && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./files.vue?vue&type=style&index=0&id=41453638&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./files.vue?vue&type=style&index=0&id=41453638&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"resource\"},[_c('el-page-header',{attrs:{\"content\":\"文件中转\"},on:{\"back\":function($event){return _vm.$router.push('/')}}}),_c('div',{staticClass:\"actions\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.openDialog}},[_vm._v(\"上传文件\")])],1),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticClass:\"full-width\",attrs:{\"data\":_vm.rows,\"stripe\":\"\",\"border\":\"\"}},[_vm._l((_vm.columns),function(column,index){return _c('el-table-column',{key:index,attrs:{\"prop\":column.name,\"label\":column.title,\"width\":column.width,\"min-width\":column.minWidth,\"show-overflow-tooltip\":true,\"fixed\":column.fixed,\"sortable\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\"\\n                \"+_vm._s(column.name === 'alias' ? _vm.aliasFilter(scope.row[column.name]) : (column.format ?\n                column.format(scope.row[column.name]) : scope.row[column.name]))+\"\\n            \")]}}],null,true)})}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"min-width\":\"220\",\"width\":\"240\",\"fixed\":\"right\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"size\":\"mini\",\"title\":\"下载资源\",\"type\":\"success\",\"icon\":\"el-icon-download\"},on:{\"click\":function($event){return _vm.downloadItem(scope.row)}}})]}}])})],2),_c('div',{staticClass:\"paging padding\"},[_c('el-pagination',{attrs:{\"background\":\"\",\"layout\":\"prev, pager, next\",\"total\":_vm.filterList.length,\"current-page\":_vm.currentPage,\"hide-on-single-page\":true},on:{\"update:currentPage\":function($event){_vm.currentPage=$event},\"update:current-page\":function($event){_vm.currentPage=$event}}})],1),_c('el-dialog',{attrs:{\"title\":\"上传文件\",\"visible\":_vm.dialogShow,\"width\":\"450px\",\"modal-append-to-body\":false},on:{\"update:visible\":function($event){_vm.dialogShow=$event},\"closed\":function($event){_vm.dialogShow = false}}},[_c('el-form',{ref:\"upgrade\",attrs:{\"model\":_vm.file,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"prop\":\"bin\",\"label\":\"资源文件\"},nativeOn:{\"click\":function($event){return _vm.pickFile($event)}}},[_c('el-input',{attrs:{\"placeholder\":\"点击选择一个文件\",\"disabled\":_vm.uploadProcessing},model:{value:(_vm.file.bin),callback:function ($$v) {_vm.$set(_vm.file, \"bin\", $$v)},expression:\"file.bin\"}}),_c('div',{staticClass:\"file-field\"},[_c('input',{ref:\"file_field\",attrs:{\"type\":\"file\"},on:{\"change\":_vm.setFile}})])],1)],1),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":function($event){_vm.dialogShow = false}}},[_vm._v(\"取消\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"loading\":_vm.uploadProcessing},on:{\"click\":_vm.submit}},[_vm._v(_vm._s(_vm.uploadProcessing ? '提交中...' : '保存'))])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"resource\">\r\n        <el-page-header @back=\"$router.push('/')\" content=\"文件中转\">\r\n        </el-page-header>\r\n        <div class=\"actions\">\r\n            <el-button type=\"primary\" @click=\"openDialog\">上传文件</el-button>\r\n            <!-- <el-upload\r\n                class=\"upload-demo\"\r\n                action=\"https://jsonplaceholder.typicode.com/posts/\"\r\n                :on-preview=\"handlePreview\"\r\n                :on-remove=\"handleRemove\"\r\n                :before-remove=\"beforeRemove\"\r\n                multiple\r\n                :limit=\"3\"\r\n                :on-exceed=\"handleExceed\"\r\n                :file-list=\"fileList\">\r\n                <el-button size=\"small\" type=\"primary\">上传文件</el-button>\r\n            </el-upload> -->\r\n        </div>\r\n        <el-table class=\"full-width\" :data=\"rows\" v-loading=\"loading\" stripe border>\r\n            <el-table-column\r\n                v-for=\"(column, index) in columns\"\r\n                :key=\"index\"\r\n                :prop=\"column.name\"\r\n                :label=\"column.title\"\r\n                :width=\"column.width\"\r\n                :min-width=\"column.minWidth\"\r\n                :show-overflow-tooltip=\"true\"\r\n                :fixed=\"column.fixed\"\r\n                sortable\r\n            >\r\n                <template slot-scope=\"scope\">\r\n                    {{ column.name === 'alias' ? aliasFilter(scope.row[column.name]) : (column.format ?\r\n                    column.format(scope.row[column.name]) : scope.row[column.name]) }}\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" min-width=\"220\" width=\"240\" fixed=\"right\">\r\n                \r\n                <template slot-scope=\"scope\">\r\n                      <el-button size=\"mini\" title=\"下载资源\" type=\"success\" @click=\"downloadItem(scope.row)\" icon=\"el-icon-download\"/>\r\n                    <!-- <el-button size=\"mini\" title=\"版本更新\" type=\"primary\" @click=\"upgradeItem(scope.row)\" icon=\"el-icon-upload\"/>\r\n                    <el-button size=\"mini\" title=\"资源编辑\" type=\"warning\" @click=\"editItem(scope.row)\" icon=\"el-icon-edit\"/>\r\n                  \r\n                    <el-button size=\"mini\" title=\"资源删除\" type=\"danger\" @click=\"removeItem(scope.row)\" icon=\"el-icon-delete\"/> -->\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n        <div class=\"paging padding\">\r\n            <el-pagination background layout=\"prev, pager, next\" :total=\"filterList.length\" :current-page.sync=\"currentPage\" :hide-on-single-page=\"true\"/>\r\n        </div>\r\n        <el-dialog title=\"上传文件\" :visible.sync=\"dialogShow\" width=\"450px\" :modal-append-to-body=\"false\" @closed=\"dialogShow = false\">\r\n            <el-form :model=\"file\" ref=\"upgrade\" label-width=\"100px\">\r\n                <el-form-item prop=\"bin\" label=\"资源文件\" @click.native=\"pickFile\">\r\n                    <el-input v-model=\"file.bin\" placeholder=\"点击选择一个文件\" :disabled=\"uploadProcessing\"/>\r\n                    <div class=\"file-field\">\r\n                        <input ref=\"file_field\" type=\"file\" @change=\"setFile\"/>\r\n                    </div>\r\n                </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\">\r\n                <el-button size=\"small\" @click=\"dialogShow = false\">取消</el-button>\r\n                <el-button type=\"primary\" size=\"small\" :loading=\"uploadProcessing\" @click=\"submit\">{{ uploadProcessing ? '提交中...' : '保存' }}</el-button>\r\n            </div>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    const columns =[\r\n        {\r\n            title: '文件名称',\r\n            name: 'name',\r\n        },\r\n        {\r\n            title: '创建时间',\r\n            name: 'time'\r\n        },\r\n    ]\r\n    import * as http from '@/libs/request';\r\n    import { getToken } from '@/libs/auth';\r\n    import { formatDate } from '@/libs/moment';\r\n    export default {\r\n        data: () => ({\r\n            columns,\r\n            loading: false,\r\n            dialogShow: false,\r\n            currentPage: 1,\r\n            bin: null,\r\n            file: {\r\n                bin: '',\r\n            },\r\n            filterList:[],\r\n            uploadProcessing: false\r\n        }),\r\n        methods: {\r\n            openDialog(){\r\n                this.dialogShow = true;\r\n                if(this.bin){\r\n                    this.$refs.file_field.value = ''\r\n                     this.bin = null;\r\n                    this.file.bin = ''\r\n                }\r\n                console.log()\r\n            },\r\n            listResource() {\r\n                this.loading = true;\r\n                http.filesList({\r\n                    success: res => {\r\n                        let list = []\r\n                        if(res){\r\n                            for(let i in res){\r\n                               list.push(res[i])\r\n                            }\r\n                        }else{\r\n                            this.list = []\r\n                        }\r\n                        this.filterList = list.length?list.map(({key, name, time}) => {\r\n                                return{\r\n                                    key,name,\r\n                                    time: formatDate(time)\r\n                                }\r\n                            }) : []\r\n                        this.loading = false;\r\n                    },\r\n                    fail: err => {\r\n                        this.$message.error('获取资源列表失败, ' + err);\r\n                        this.loading = false;\r\n                    }\r\n                })\r\n            },\r\n            pickFile(ev) {\r\n                let { file_field } = this.$refs;\r\n                file_field.click();\r\n                setTimeout(() => {\r\n                    ev.target.blur()\r\n                }, 100);\r\n            },\r\n            setFile(ev) {\r\n                let files = ev.target.files;\r\n                if (files.length > 0) {\r\n                    this.bin = files[0];\r\n                    this.file.bin = files[0].name;\r\n                } else {\r\n                    this.bin = null;\r\n                }\r\n            },\r\n            downloadItem({ key }){\r\n                window.location.href = http.getBaseUrl() + `tmp/download?key=${key}`\r\n            },\r\n            submit(){\r\n                if(!this.bin)return\r\n                this.uploadProcessing = true\r\n                let formData = new FormData();\r\n                formData.append('file', this.bin)\r\n                http.fileUplad(formData, {\r\n                    success: res => {\r\n                        this.dialogShow = false\r\n                        this.listResource();\r\n                        this.uploadProcessing = false\r\n                    },\r\n                    fail: err => {\r\n                        this.$message.error('上传失败, ' + err);\r\n                        this.uploadProcessing = false\r\n                    }\r\n                })\r\n            },\r\n        },\r\n        computed: {\r\n            rows() {\r\n                let limit = (this.currentPage - 1) * 10;\r\n                return this.filterList.slice(limit, limit + 10);\r\n            }\r\n        },\r\n        mounted() {\r\n            this.listResource();\r\n        },\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .resource{\r\n        padding: 24px;\r\n    }\r\n    .actions{\r\n        margin-top: 24px;\r\n        text-align: right;\r\n    }\r\n    \r\n    .paging {\r\n        display: flex;\r\n        justify-content: center;\r\n    }\r\n\r\n    .file-field {\r\n        height: 0;\r\n        overflow: hidden;\r\n    }\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./files.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./files.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./files.vue?vue&type=template&id=41453638&scoped=true&\"\nimport script from \"./files.vue?vue&type=script&lang=js&\"\nexport * from \"./files.vue?vue&type=script&lang=js&\"\nimport style0 from \"./files.vue?vue&type=style&index=0&id=41453638&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"41453638\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}